<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://kit.fontawesome.com/81b8b08bb1.js" crossorigin="anonymous"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Libre+Franklin:wght@100;200;300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='logo.jpg') }}">
</head>

<body class="bg-white h-screen flex flex-col items-center">
    <div id='tophalf' class="w-full p-4 h-[15vh] flex justify-center bg-green-500">
        <div class="flex items-center bg-white rounded-xl p-3 shadow-lg">
            <div class="border-r border-gray-400 pr-4">
                <img src="/static/nmims-university-logo.png" class="w-32">
            </div>
            <p class="text-lg font-light ml-4 text-center">Mukesh Patel School Of Technology & Engineering</p>
        </div>
    </div>
    <div class="w-full flex justify-center items-center mt-6 px-4 ">
        <form action="/report" method="post"
            class="flex flex-wrap items-center justify-center gap-3 bg-[#CCFCCC] p-4 rounded-lg shadow-lg w-full max-w-lg">
            <input type="text" name="formflag" value="genreport" style="display: none;">
            <select name="month" class="p-3 rounded-lg w-full md:w-auto border border-gray-300 text-sm" required>
                <option value="">Month</option>
                <option value="JAN">JAN</option>
                <option value="FEB">FEB</option>
                <option value="MAR">MAR</option>
                <option value="APR">APR</option>
                <option value="MAY">MAY</option>
                <option value="JUN">JUN</option>
                <option value="JUL">JUL</option>
                <option value="AUG">AUG</option>
                <option value="SEP">SEP</option>
                <option value="OCT">OCT</option>
                <option value="NOV">NOV</option>
                <option value="DEC">DEC</option>
            </select>
            <input type="text" name="year" placeholder="enter year YYYY"
                class="p-3 rounded-lg w-full md:w-auto border border-gray-300" required maxlength="4">
            <button
                class="bg-indigo-600 text-white px-5 py-3 rounded-lg hover:bg-indigo-700 transition-all text-sm md:text-base shadow-xl">
                Generate
            </button>
        </form>
        <form action="/adminpanel" method="post" class="ml-6">
            <input type="hidden" name="formflag" readonly>
            <button
                class="bg-red-600 text-white px-5 py-3 rounded-lg  shadow-lg hover:bg-red-700 transition-all text-sm md:text-base shadow-xl">
                Back to Dashboard
            </button>
        </form>
    </div>
    {% if reportdata %}
    <div
        class="w-full max-w-6xl mx-auto bg-gray-100 p-4 rounded-lg shadow-md flex flex-wrap gap-3 justify-center items-center mt-4">
        <p class="text-gray-700 text-sm font-semibold">Data For:</p>
        <div class="flex flex-wrap gap-2">
            <span
                class="bg-blue-500 text-white px-4 py-2 rounded-full text-sm font-semibold shadow-md">{{reportdata[0]['month']}}
                {{reportdata[0]['year']}}</span>
        </div>
        <form action="/report" method="post">
            <input type="text" name="formflag" value="downloadreport" style="display: none;">
            <button type="submit"
                class="bg-[#583da1] text-white px-4 py-2 rounded-lg hover:bg-slate-500 transition-all text-xs md:text-sm font-semibold shadow-md">
                Download Report
            </button>
        </form>
    </div>
    {% endif %}
    <div class="w-full flex justify-center mt-8 mb-8 px-4">
        <div class="overflow-x-auto w-full max-w-6xl ">
            <table
                class="table-fixed bg-blue-100 border-gray-400 shadow-2xl rounded-2xl w-full text-center text-sm md:text-base overflow-hidden">
                <thead class="bg-blue-600 text-white text-xs md:text-sm">
                    <tr>
                        <th class="p-3 md:p-4">Class Number</th>
                        <th class="p-3 md:p-4">Description</th>
                        <th class="p-3 md:p-4">Component ID</th>
                        <th class="p-3 md:p-4">Image</th>
                        <th class="p-3 md:p-4">Phase</th>
                        <th class="p-3 md:p-4">Status</th>
                        <th class="p-3 md:p-4">More Info</th>
                    </tr>
                </thead>
                <tbody>
                    {% if not reportdata %}
                    <tr>
                        <td colspan="6" class="p-3 md:p-4">No records found</td>
                    </tr>
                    {% else %}
                    {% for element in reportdata %}
                    <tr class="hover:bg-blue-50 transition-all">
                        <td class="p-4 md:p-4 text-gray-800">{{ element['classroom'] }}</td>
                        <td class="p-4 md:p-4 text-gray-800 truncate whitespace-nowrap overflow-hidden">{{
                            element['complaint'] }}</td>
                        <td class="p-4 md:p-4 text-gray-800">{{ element['componentid'] }}</td>
                        <td class="p-4 md:p-4">
                            <a href="{{ element['imageurl'] }}" target="_blank"
                                class="text-blue-500 hover:underline">View</a>
                        </td>
                        <td class="p-4 md:p-4 text-gray-800">{{ element['phase'] }}</td>
                        <td class="p-4 md:p-4">
                            {% if element['completed'] %}
                            Completed
                            {% else %}
                            Pending
                            {% endif %}
                        </td>
                        <td class="p-4 md:p-4">
                            <form action="/complaintdetails/{{ element['id'] }}" method="post">
                                <input type="hidden" name="formflag" value="viewcomplaint">
                                <button
                                    class="bg-purple-500 hover:bg-purple-600 text-white px-3 py-2 rounded-md transition-all text-xs md:text-sm">
                                    click
                                </button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>
</body>

</html>